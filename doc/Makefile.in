GENERATED = gauche-refe.texi gauche-refj.texi
GOSH = gosh
INSTALL = @INSTALL@

# Manual page destination.  Default @mandir@ doesn't include 'share'
# in the path, so I redefine it---a user can still override it by
# make mandir=wherever
prefix  = @prefix@
datadir = @datadir@
mandir  = $(datadir)/man/man1

MANPAGES = gosh.1 gauche-config.1

all:

install:
	if test ! -d $(mandir); then\
	  $(INSTALL) -d $(mandir); \
	fi
	for m in $(MANPAGES); do \
	  $(INSTALL) -m 444 $$m $(mandir); \
	done

texi : gauche-refe.texi gauche-refj.texi

html : gauche-refe.html gauche-refj.html

htmls : gauche-refe_toc.html gauche-refj_toc.html

dvi : gauche-refe.dvi

pdf : gauche-refe.pdf

gauche-refe.html : gauche-refe.texi
	texi2html -number gauche-refe.texi

gauche-refe_toc.html : gauche-refe.texi
	texi2html -split section -number gauche-refe.texi

gauche-refe.dvi : gauche-refe.texi
	texi2dvi gauche-refe.texi

gauche-refe.pdf : gauche-refe.texi
	texi2pdf gauche-refe.texi

gauche-refe.texi : gauche-ref.texi extract
	$(GOSH) ./extract -en -o gauche-refe.texi gauche-ref.texi

gauche-refj.html : gauche-refj.texi
	texi2html -number gauche-refj.texi

gauche-refj_toc.html : gauche-refj.texi
	texi2html -split section -number gauche-refj.texi

gauche-refj.dvi : gauche-refj.texi
	texi2dvi gauche-refj.texi

gauche-refj.pdf : gauche-refj.texi
	texi2pdf gauche-refj.texi

gauche-refj.texi : gauche-ref.texi extract
	$(GOSH) ./extract -jp -o gauche-refj.texi gauche-ref.texi

clean:
	rm -rf core *~ *.aux *.cl *.cls *.cp *.fn *.fns *.ky *.log *.md *.mds \
	       *.pg *.toc *.tp *.tps *.vr *.vrs *.pdf *.dvi

distclean : clean
	rm -rf $(GENERATED)

realclean : clean
	rm -f gauche-ref*.html gauche-ref.dvi $(GENERATED)


