srcdir       = @srcdir@
top_builddir = @top_builddir@
top_srcdir   = @top_srcdir@

include ../Makefile.ext

SCM_CATEGORY = gauche

LIBFILES = libgauche-uvector.$(SOEXT)
SCMFILES = array.scm uvector.scm matrix.scm
HDRFILES = gauche/uvector.h

GENERATED = Makefile uvlib.c uvlib.stub uvector.c gauche/uvector.h \
            uvutil.c uvector_head.c uvector_tail.c

all : $(LIBFILES)

uvector_OBJECTS = uvector_head.$(OBJEXT) uvector.$(OBJEXT) uvutil.$(OBJEXT) \
                  uvinit.$(OBJEXT) uvlib.$(OBJEXT) uvector_tail.$(OBJEXT)

libgauche-uvector.$(SOEXT) : $(uvector_OBJECTS) 
	$(MODLINK) libgauche-uvector.$(SOEXT) $(uvector_OBJECTS) $(EXT_LIBGAUCHE) $(LIBS)

uvector_head.c uvector_tail.c :
	$(GAUCHE_CONFIG) --fixup-extension uvector

gauche/uvector.h : uvector.h.sh
	if test ! -d gauche; then mkdir gauche; fi
	rm -rf gauche/uvector.h
	sh ./uvector.h.sh > gauche/uvector.h

uvector.$(OBJEXT) uvutil.$(OBJEXT) uvlib.$(OBJEXT) uvinit.$(OBJEXT) : gauche/uvector.h

uvector.c : uvector.c.sh
	rm -rf uvector.c
	sh ./uvector.c.sh > uvector.c

uvutil.c : uvutil.c.sh
	rm -rf uvutil.c
	sh ./uvutil.c.sh > uvutil.c

uvlib.c : uvlib.stub

uvlib.stub : uvlib.stub.sh
	rm -rf uvlib.stub
	sh ./uvlib.stub.sh > uvlib.stub

install : install-std

